## 事件委托或事件代理

## 概述

**事件委托是利用事件冒泡，只指定一个事件处理程序，就可以管理某一类型的所有事件**，可借助公司前台代收快递的例子理解

 由于事件会在冒泡阶段向上传播到父节点，因此可以把子节点的监听函数定义在父节点上，由父节点的监听函数统一处理多个子元素的事件。这种方法叫做事件的代理（delegation） 

### 为什么要使用事件委托

一般来说，dom需要有事件处理程序，我们都会直接给它设事件处理程序。那如果是很多的dom需要添加事件处理呢？比如我们有100个li，每个li都有相同的click 事件，可能我们会用for循环的方法来遍历所有的li，然后给它们添加事件，但这样做会影响页面整体运行性能。

在js中，添加页面上的事件处理程序数量将直接关系到页面的整体运行性能，因为需要不断的和dom节点进行交互，访问dom的次数越多，引起浏览器重绘和重排的次数也越多，就会延长整个页面交互的就绪时间，**这就是为什么性能优化的主要思想之一就是减少DOM操作的原因**；如果要用时间委托，就会将所有的操作放在js程序里面，与DOM的操作就只需要交互一次，这样能大大减少与DOM的交互次数，提高性能；

每一个函数都是一个对象，是对象就会占用内存，对象越多，内存占用率就会越大，自然性能就越差。比如上面有100个li，就要占用100个内存空间，**但如果使用事件委托，就可以只对它的父级这一个对象进行操作，这样我们就只需要一个内存空间就够了，性能自然就会好**

### 事件委托的原理

事件委托是利用事件冒泡原理来实现的，事件冒泡为事件从最深的节点开始，然后逐步向上传播事件那么我们点击li时，这个事件就会往外执行到ul上，我们给ul添加事件，在li中做点击事件时的会冒泡在最外层的div上，所以就会触发，这就是事件委托，**委托它们父级代为执行事件**

 ### 事件委托怎么实现

```html
<ul id="ull">
    <li>11</li>
    <li>22</li>
    <li>11</li>
    <li>11</li>
</ul>

<script>
    //普通 下面代码涉及DOM操作较多，首先要找到ul，然后遍历li,然后点击li的时候，又要找一次目标li的位置，才能执行最后操作，每次点击的要找一次li 
    var ul = document.getElementById('ull');
    var ali = ul.getElementsByTagName('li');
    for(var i = 0; i < li.length; i++){
        li[i].onclick = function(){
            alert(123)
        }
    }
    //使用事件委托,在父级ul做事件处理，当li被点击时，由于冒泡原理，事件就会冒泡到ul上，可以使用target返回事件的目标节点，target可以表示为当前的事件操作的dom
    window.onload = function(){
        ul.onclick = function(ev){
            var target = ev.target || ev.srcElement;
            if(target.nodeName.toLowerCase() == 'li'){
             	alert(123);   
            }
        }
    }
	
</script>
```

以上使用事件委托则点击li会触发事件，且执行一次dom操作，如果li数量很多，将会大大减少dom操作。

**使用事件委托也可以实现点击不同li实现不同方法（target+switch）**

- 使用事件委托优点
  -  动态绑定事件 ，使用事件委托对于新添加的元素也是带有事件效果的。
  -  减少内存消耗，提高性能(不需要为每一个子元素绑定事件) ；使用事件委托时，根本就不需要去遍历元素子节点，只需要给父级元素添加事件就好了，其他的都是在js里面执行，这样可以大大的减少dom操作
- 适合事件委托的事件：click,mousedown,mouseup,keydown,keyup.keypress
- 不适合事件委托的事件：mouseover和mouseout虽然也有事件冒泡，但因为需要计算它们的位置，不容易把控，处理起来不太容易。再比如focus，blur之类，本身没有冒泡特性，自然就不能用事件委托

 https://www.cnblogs.com/liugang-vip/p/5616484.html  