## XSS

XSS跨站脚本攻击。跨站脚本攻击是指在 存在安全漏洞的Web网站注册用户的浏览器内运行非法HTML标签或javascript进行的一种攻击

**XSS的原理是恶意攻击者往Web页面里插入恶意可执行网页脚本代码，当用户浏览该页之时，嵌入Web其中的脚本代码会被执行，从而可以达到攻击者盗取用户信息或遣返用户安全隐私的目的**

### 持久型XSS

持久型XSS一般存在与Form表单中，如文章留言等，黑客利用XSS的漏洞，将内容经正常提交进入数据库持久保存，当前端页面获得后端从数据库中读取的注入代码时，恰好将其渲染执行。

 这种攻击常见于带有用户保存数据的网站功能，如论坛发帖、商品评论、用户私信等。 

攻击成功需要同时满足以下几个条件：

- POST请求提交表单后端没做转义直接入库
- 后端从数据库中取出的数据没做转义直接输出给前端
- 前端拿到后端数据没做转义直接渲染成DOM

持久型XSS特点：

- 持久性，植入在数据库中

**如何防御**

- CSP(网页安全策略)
  - CSP的制度就是白名单制度，开发者明确告诉客户端，哪些外部元素可以加载和执行，等同于提供了白名单，它的实现和执行全部由浏览器完成，开发者只需要提供配置。这种情况下，攻击者就算发现漏洞，也没法注入脚本，除非还控制一台列入了白名单的可信主机
  - 开启方式：HTTP头信息的Content-Security-Policy字段
  - default-src 'none'; script-src 'self'; connect-src 'self'; img-src 'self'; style-src 'self';
- 转义字符
  - **用户的输入永远不可信，最普遍的做法就是转义输入输出内容**，对于引号(&quto;)、尖括号(<:&lt >&gt)、斜杠(&#x2F)进行转义
  - 使用使用 npm 包来简化操作，js-xss(第三方库)来实现转义



